"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("wonka"),u=require("scheduler"),t="undefined"==typeof window,n=t?e.useEffect:e.useLayoutEffect,c=function(c,a,s){var l=e.useRef({subject:r.makeSubject(),value:s,onValue:function(e){l.current.value=e},teardown:null,task:null}),o=e.useReducer((function(e,r){return l.current.value=r,e+1}),0)[1];if(null===l.current.teardown){var i=r.subscribe((function(e){return l.current.onValue(e)}))(c(l.current.subject.source)).unsubscribe;l.current.subject.next(a),t?i():(l.current.teardown=i,l.current.task=u.unstable_scheduleCallback(u.unstable_getCurrentPriorityLevel(),l.current.teardown))}function b(){null!==l.current.teardown&&l.current.teardown()}return n((function(){return null!==l.current.task&&u.unstable_cancelCallback(l.current.task),b}),[]),e.useEffect((function(){var e=l.current.onValue!==o;l.current.onValue=o,null===l.current.teardown&&(l.current.teardown=r.subscribe(o)(c(l.current.subject.source)).unsubscribe),e||l.current.subject.next(a)}),[a]),[l.current.value,l.current.subject.next]};exports.useOperator=c,exports.useOperatorValue=function(e,r,u){return c(e,r,u)[0]};
