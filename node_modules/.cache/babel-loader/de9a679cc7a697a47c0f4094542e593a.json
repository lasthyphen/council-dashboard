{"ast":null,"code":"import _slicedToArray from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled from\"styled-components\";import React,{useCallback,useEffect,useMemo,useRef,useState}from'react';import{useWallet}from'use-wallet';import{Button,GU,IconConnect,useViewport}from'@aragon/ui';import{shortenAddress}from'../../lib/web3-utils';import AccountButton from'./AccountButton';import AccountPopover from'./AccountPopover';import ScreenConnected from'./ScreenConnected';import ScreenConnecting from'./ScreenConnecting';import ScreenError from'./ScreenError';import ScreenProviders from'./ScreenProviders';var SCREENS=[{id:'providers',title:'Use account from'},{id:'connecting',title:'Use account from'},{id:'connected',title:'Active account'},{id:'error',title:'Connection error'}];var _StyledDiv=_styled(\"div\").withConfig({displayName:\"AccountModule___StyledDiv\",componentId:\"sukdq6-0\"})([\"display:flex;align-items:center;justify-content:space-around;width:\",\";outline:0;\"],function(p){return p._css;});function AccountModule(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),opened=_useState2[0],setOpened=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),activatingDelayed=_useState4[0],setActivatingDelayed=_useState4[1];var buttonRef=useRef();var _useViewport=useViewport(),below=_useViewport.below;var compactMode=below('medium');var wallet=useWallet();var account=wallet.account,connector=wallet.connector,error=wallet.error,status=wallet.status;var open=useCallback(function(){return setOpened(true);},[]);var toggle=useCallback(function(){return setOpened(function(opened){return!opened;});},[]);useEffect(function(){var timer;if(status==='error'){setActivatingDelayed(null);}if(status==='connecting'){setActivatingDelayed(connector);timer=setTimeout(function(){setActivatingDelayed(null);},400);}return function(){return clearTimeout(timer);};},[connector,status]);var handleResetConnection=useCallback(function(){wallet.reset();},[wallet]);var handleActivate=useCallback(function(providerId){return wallet.connect(providerId);},[wallet]);var previousScreenIndex=useRef(-1);var _useMemo=useMemo(function(){var screenId=status==='disconnected'?'providers':status;var screenIndex=SCREENS.findIndex(function(screen){return screen.id===screenId;});var direction=previousScreenIndex.current>screenIndex?-1:1;previousScreenIndex.current=screenIndex;return{direction:direction,screenIndex:screenIndex};},[status]),screenIndex=_useMemo.screenIndex,direction=_useMemo.direction;var screen=SCREENS[screenIndex];var screenId=screen.id;var handlePopoverClose=useCallback(function(){if(screenId==='connecting'||screenId==='error'){// reject closing the popover\nreturn false;}setOpened(false);},[screenId]);return React.createElement(_StyledDiv,{ref:buttonRef,tabIndex:\"0\",_css:compactMode?'auto':\"\".concat(24.5*GU,\"px\")},screen.id==='connected'?React.createElement(AccountButton,{label:shortenAddress(wallet.account),onClick:toggle}):React.createElement(Button,{icon:React.createElement(IconConnect,null),label:\"Connect account\",onClick:toggle,display:compactMode?'icon':'all'}),React.createElement(AccountPopover,{direction:direction,heading:screen.title,keys:function keys(_ref){var screenId=_ref.screenId;return screenId+status+error.name;},onClose:handlePopoverClose,onOpen:open,opener:buttonRef.current,screenId:screenId,screenData:{account:account,activating:activatingDelayed,activationError:error,status:status,screenId:screenId},screenKey:function screenKey(_ref2){var account=_ref2.account,activating=_ref2.activating,activationError=_ref2.activationError,screenId=_ref2.screenId;return(activationError?activationError.name:'')+account+activating+screenId;},visible:opened},function(_ref3){var activating=_ref3.activating,activationError=_ref3.activationError,screenId=_ref3.screenId;if(screenId==='connecting'){return React.createElement(ScreenConnecting,{providerId:activating,onCancel:handleResetConnection});}if(screenId==='connected'){return React.createElement(ScreenConnected,{wallet:wallet});}if(screenId==='error'){return React.createElement(ScreenError,{error:activationError,onBack:handleResetConnection});}return React.createElement(ScreenProviders,{onActivate:handleActivate});}));}export default AccountModule;","map":{"version":3,"sources":["/Users/saleemfareed/oneds/court-dashboard/src/components/Account/AccountModule.js"],"names":["React","useCallback","useEffect","useMemo","useRef","useState","useWallet","Button","GU","IconConnect","useViewport","shortenAddress","AccountButton","AccountPopover","ScreenConnected","ScreenConnecting","ScreenError","ScreenProviders","SCREENS","id","title","AccountModule","opened","setOpened","activatingDelayed","setActivatingDelayed","buttonRef","below","compactMode","wallet","account","connector","error","status","open","toggle","timer","setTimeout","clearTimeout","handleResetConnection","reset","handleActivate","providerId","connect","previousScreenIndex","screenId","screenIndex","findIndex","screen","direction","current","handlePopoverClose","name","activating","activationError"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { useWallet } from 'use-wallet'\nimport { Button, GU, IconConnect, useViewport } from '@aragon/ui'\nimport { shortenAddress } from '../../lib/web3-utils'\nimport AccountButton from './AccountButton'\nimport AccountPopover from './AccountPopover'\nimport ScreenConnected from './ScreenConnected'\nimport ScreenConnecting from './ScreenConnecting'\nimport ScreenError from './ScreenError'\nimport ScreenProviders from './ScreenProviders'\n\nconst SCREENS = [\n  { id: 'providers', title: 'Use account from' },\n  { id: 'connecting', title: 'Use account from' },\n  { id: 'connected', title: 'Active account' },\n  { id: 'error', title: 'Connection error' },\n]\n\nfunction AccountModule() {\n  const [opened, setOpened] = useState(false)\n  const [activatingDelayed, setActivatingDelayed] = useState(null)\n  const buttonRef = useRef()\n  const { below } = useViewport()\n  const compactMode = below('medium')\n  const wallet = useWallet()\n  const { account, connector, error, status } = wallet\n\n  const open = useCallback(() => setOpened(true), [])\n  const toggle = useCallback(() => setOpened(opened => !opened), [])\n\n  useEffect(() => {\n    let timer\n\n    if (status === 'error') {\n      setActivatingDelayed(null)\n    }\n\n    if (status === 'connecting') {\n      setActivatingDelayed(connector)\n      timer = setTimeout(() => {\n        setActivatingDelayed(null)\n      }, 400)\n    }\n\n    return () => clearTimeout(timer)\n  }, [connector, status])\n\n  const handleResetConnection = useCallback(() => {\n    wallet.reset()\n  }, [wallet])\n\n  const handleActivate = useCallback(providerId => wallet.connect(providerId), [\n    wallet,\n  ])\n\n  const previousScreenIndex = useRef(-1)\n\n  const { screenIndex, direction } = useMemo(() => {\n    const screenId = status === 'disconnected' ? 'providers' : status\n\n    const screenIndex = SCREENS.findIndex(screen => screen.id === screenId)\n    const direction = previousScreenIndex.current > screenIndex ? -1 : 1\n\n    previousScreenIndex.current = screenIndex\n\n    return { direction, screenIndex }\n  }, [status])\n\n  const screen = SCREENS[screenIndex]\n  const screenId = screen.id\n\n  const handlePopoverClose = useCallback(() => {\n    if (screenId === 'connecting' || screenId === 'error') {\n      // reject closing the popover\n      return false\n    }\n    setOpened(false)\n  }, [screenId])\n\n  return (\n    <div\n      ref={buttonRef}\n      tabIndex=\"0\"\n      css={`\n        display: flex;\n        align-items: center;\n        justify-content: space-around;\n        width: ${compactMode ? 'auto' : `${24.5 * GU}px`};\n        outline: 0;\n      `}\n    >\n      {screen.id === 'connected' ? (\n        <AccountButton\n          label={shortenAddress(wallet.account)}\n          onClick={toggle}\n        />\n      ) : (\n        <Button\n          icon={<IconConnect />}\n          label=\"Connect account\"\n          onClick={toggle}\n          display={compactMode ? 'icon' : 'all'}\n        />\n      )}\n      <AccountPopover\n        direction={direction}\n        heading={screen.title}\n        keys={({ screenId }) => screenId + status + error.name}\n        onClose={handlePopoverClose}\n        onOpen={open}\n        opener={buttonRef.current}\n        screenId={screenId}\n        screenData={{\n          account,\n          activating: activatingDelayed,\n          activationError: error,\n          status,\n          screenId,\n        }}\n        screenKey={({ account, activating, activationError, screenId }) =>\n          (activationError ? activationError.name : '') +\n          account +\n          activating +\n          screenId\n        }\n        visible={opened}\n      >\n        {({ activating, activationError, screenId }) => {\n          if (screenId === 'connecting') {\n            return (\n              <ScreenConnecting\n                providerId={activating}\n                onCancel={handleResetConnection}\n              />\n            )\n          }\n          if (screenId === 'connected') {\n            return <ScreenConnected wallet={wallet} />\n          }\n          if (screenId === 'error') {\n            return (\n              <ScreenError\n                error={activationError}\n                onBack={handleResetConnection}\n              />\n            )\n          }\n          return <ScreenProviders onActivate={handleActivate} />\n        }}\n      </AccountPopover>\n    </div>\n  )\n}\n\nexport default AccountModule\n"]},"metadata":{},"sourceType":"module"}