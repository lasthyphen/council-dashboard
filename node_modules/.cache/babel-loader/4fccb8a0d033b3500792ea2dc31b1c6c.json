{"ast":null,"code":"import _objectSpread from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled4 from\"styled-components\";import _styled3 from\"styled-components\";import _styled2 from\"styled-components\";import _styled from\"styled-components\";import React,{useCallback,useState}from'react';import{Button,ButtonBase,Field,GU,Info,TextInput,useSidePanelFocusOnReady,useTheme}from'@aragon/ui';import{useCourtConfig}from'../../../providers/CourtConfig';import{parseUnits,formatUnits,bigNum}from'../../../lib/math-utils';var _StyledField=_styled(Field).withConfig({displayName:\"ANJForm___StyledField\",componentId:\"sc-15npst5-0\"})([\"margin-bottom:\",\"px;\"],function(p){return p._css;});var _StyledButtonBase=_styled(ButtonBase).withConfig({displayName:\"ANJForm___StyledButtonBase\",componentId:\"sc-15npst5-1\"})([\"margin-right:\",\"px;color:\",\";\"],function(p){return p._css2;},function(p){return p._css3;});var _StyledInfo=_styled(Info).withConfig({displayName:\"ANJForm___StyledInfo\",componentId:\"sc-15npst5-2\"})([\"margin-bottom:\",\"px;\"],function(p){return p._css4;});var _StyledButton=_styled(Button).withConfig({displayName:\"ANJForm___StyledButton\",componentId:\"sc-15npst5-3\"})([\"margin-bottom:\",\"px;\"],function(p){return p._css5;});var ANJForm=React.memo(function ANJForm(_ref){var actionLabel=_ref.actionLabel,maxAmount=_ref.maxAmount,onDone=_ref.onDone,onSubmit=_ref.onSubmit,runParentValidation=_ref.runParentValidation;var _useState=useState({value:'0',valueBN:bigNum(0),error:null}),_useState2=_slicedToArray(_useState,2),amount=_useState2[0],setAmount=_useState2[1];var theme=useTheme();var _useCourtConfig=useCourtConfig(),anjToken=_useCourtConfig.anjToken;var inputRef=useSidePanelFocusOnReady();var handleEditMode=useCallback(function(editMode){setAmount(function(amount){return _objectSpread({},amount,{value:formatUnits(amount.valueBN,{digits:anjToken.decimals,commas:!editMode,replaceZeroBy:editMode?'':'0',precision:anjToken.decimals})});});},[anjToken.decimals]);// Change amount handler\nvar handleAmountChange=useCallback(function(event){var newAmount=event.target.value;var newAmountBN;try{newAmountBN=parseUnits(newAmount,anjToken.decimals);}catch(err){newAmountBN=bigNum(-1);}setAmount(function(amount){return _objectSpread({},amount,{value:newAmount,valueBN:newAmountBN});});},[anjToken.decimals]);// Max value selection handler\nvar handleOnSelectMaxValue=useCallback(function(){setAmount(function(amount){return _objectSpread({},amount,{value:formatUnits(maxAmount,{digits:anjToken.decimals,precision:anjToken.decimals}),valueBN:maxAmount});});},[anjToken.decimals,maxAmount]);// Form validation\nvar validateForm=useCallback(function(){if(amount.valueBN.eq(0)){return'Amount must not be zero';}if(amount.valueBN.eq(-1)){return'Wrong amount format';}return runParentValidation(amount.valueBN);},[amount.valueBN,runParentValidation]);// Form submit\nvar handleSubmit=function handleSubmit(event){event.preventDefault();var error=validateForm(amount.valueBN);if(error){setAmount(function(amount){return _objectSpread({},amount,{error:error});});return;}setAmount(function(amount){return _objectSpread({},amount,{error:null});});onDone();onSubmit(amount.valueBN);};var errorMessage=amount.error;return React.createElement(\"form\",{onSubmit:handleSubmit},React.createElement(_StyledField,{label:\"Amount\",_css:2*GU},React.createElement(TextInput,{name:\"amount\",wide:true,onChange:handleAmountChange,onFocus:function onFocus(){return handleEditMode(true);},onBlur:function onBlur(){return handleEditMode(false);},value:amount.value,ref:inputRef,required:true,adornment:React.createElement(_StyledButtonBase,{onClick:handleOnSelectMaxValue,_css2:1*GU,_css3:theme.accent},\"MAX\"),adornmentPosition:\"end\"})),errorMessage&&React.createElement(_StyledInfo,{mode:\"error\",_css4:2*GU},errorMessage),React.createElement(_StyledButton,{label:actionLabel,mode:\"strong\",type:\"submit\",wide:true,_css5:1*GU}));});export default ANJForm;","map":{"version":3,"sources":["/Users/saleemfareed/oneds/court-dashboard/src/components/Dashboard/panels/ANJForm.js"],"names":["React","useCallback","useState","Button","ButtonBase","Field","GU","Info","TextInput","useSidePanelFocusOnReady","useTheme","useCourtConfig","parseUnits","formatUnits","bigNum","ANJForm","memo","actionLabel","maxAmount","onDone","onSubmit","runParentValidation","value","valueBN","error","amount","setAmount","theme","anjToken","inputRef","handleEditMode","editMode","digits","decimals","commas","replaceZeroBy","precision","handleAmountChange","event","newAmount","target","newAmountBN","err","handleOnSelectMaxValue","validateForm","eq","handleSubmit","preventDefault","errorMessage","accent"],"mappings":"sZAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,CAA6BC,QAA7B,KAA6C,OAA7C,CACA,OACEC,MADF,CAEEC,UAFF,CAGEC,KAHF,CAIEC,EAJF,CAKEC,IALF,CAMEC,SANF,CAOEC,wBAPF,CAQEC,QARF,KASO,YATP,CAWA,OAASC,cAAT,KAA+B,gCAA/B,CACA,OAASC,UAAT,CAAqBC,WAArB,CAAkCC,MAAlC,KAAgD,yBAAhD,C,osBAEA,GAAMC,CAAAA,OAAO,CAAGf,KAAK,CAACgB,IAAN,CAAW,QAASD,CAAAA,OAAT,MAMxB,IALDE,CAAAA,WAKC,MALDA,WAKC,CAJDC,SAIC,MAJDA,SAIC,CAHDC,MAGC,MAHDA,MAGC,CAFDC,QAEC,MAFDA,QAEC,CADDC,mBACC,MADDA,mBACC,eAC2BnB,QAAQ,CAAC,CACnCoB,KAAK,CAAE,GAD4B,CAEnCC,OAAO,CAAET,MAAM,CAAC,CAAD,CAFoB,CAGnCU,KAAK,CAAE,IAH4B,CAAD,CADnC,wCACMC,MADN,eACcC,SADd,eAMD,GAAMC,CAAAA,KAAK,CAAGjB,QAAQ,EAAtB,CANC,oBAOoBC,cAAc,EAPlC,CAOOiB,QAPP,iBAOOA,QAPP,CAQD,GAAMC,CAAAA,QAAQ,CAAGpB,wBAAwB,EAAzC,CAEA,GAAMqB,CAAAA,cAAc,CAAG7B,WAAW,CAChC,SAAA8B,QAAQ,CAAI,CACVL,SAAS,CAAC,SAAAD,MAAM,0BACXA,MADW,EAEdH,KAAK,CAAET,WAAW,CAACY,MAAM,CAACF,OAAR,CAAiB,CACjCS,MAAM,CAAEJ,QAAQ,CAACK,QADgB,CAEjCC,MAAM,CAAE,CAACH,QAFwB,CAGjCI,aAAa,CAAEJ,QAAQ,CAAG,EAAH,CAAQ,GAHE,CAIjCK,SAAS,CAAER,QAAQ,CAACK,QAJa,CAAjB,CAFJ,IAAP,CAAT,CASD,CAX+B,CAYhC,CAACL,QAAQ,CAACK,QAAV,CAZgC,CAAlC,CAeA;AACA,GAAMI,CAAAA,kBAAkB,CAAGpC,WAAW,CACpC,SAAAqC,KAAK,CAAI,CACP,GAAMC,CAAAA,SAAS,CAAGD,KAAK,CAACE,MAAN,CAAalB,KAA/B,CACA,GAAImB,CAAAA,WAAJ,CAEA,GAAI,CACFA,WAAW,CAAG7B,UAAU,CAAC2B,SAAD,CAAYX,QAAQ,CAACK,QAArB,CAAxB,CACD,CAAC,MAAOS,GAAP,CAAY,CACZD,WAAW,CAAG3B,MAAM,CAAC,CAAC,CAAF,CAApB,CACD,CAEDY,SAAS,CAAC,SAAAD,MAAM,0BACXA,MADW,EAEdH,KAAK,CAAEiB,SAFO,CAGdhB,OAAO,CAAEkB,WAHK,IAAP,CAAT,CAKD,CAhBmC,CAiBpC,CAACb,QAAQ,CAACK,QAAV,CAjBoC,CAAtC,CAoBA;AACA,GAAMU,CAAAA,sBAAsB,CAAG1C,WAAW,CAAC,UAAM,CAC/CyB,SAAS,CAAC,SAAAD,MAAM,0BACXA,MADW,EAEdH,KAAK,CAAET,WAAW,CAACK,SAAD,CAAY,CAC5Bc,MAAM,CAAEJ,QAAQ,CAACK,QADW,CAE5BG,SAAS,CAAER,QAAQ,CAACK,QAFQ,CAAZ,CAFJ,CAMdV,OAAO,CAAEL,SANK,IAAP,CAAT,CAQD,CATyC,CASvC,CAACU,QAAQ,CAACK,QAAV,CAAoBf,SAApB,CATuC,CAA1C,CAWA;AACA,GAAM0B,CAAAA,YAAY,CAAG3C,WAAW,CAAC,UAAM,CACrC,GAAIwB,MAAM,CAACF,OAAP,CAAesB,EAAf,CAAkB,CAAlB,CAAJ,CAA0B,CACxB,MAAO,yBAAP,CACD,CAED,GAAIpB,MAAM,CAACF,OAAP,CAAesB,EAAf,CAAkB,CAAC,CAAnB,CAAJ,CAA2B,CACzB,MAAO,qBAAP,CACD,CAED,MAAOxB,CAAAA,mBAAmB,CAACI,MAAM,CAACF,OAAR,CAA1B,CACD,CAV+B,CAU7B,CAACE,MAAM,CAACF,OAAR,CAAiBF,mBAAjB,CAV6B,CAAhC,CAYA;AACA,GAAMyB,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAR,KAAK,CAAI,CAC5BA,KAAK,CAACS,cAAN,GAEA,GAAMvB,CAAAA,KAAK,CAAGoB,YAAY,CAACnB,MAAM,CAACF,OAAR,CAA1B,CACA,GAAIC,KAAJ,CAAW,CACTE,SAAS,CAAC,SAAAD,MAAM,0BAAUA,MAAV,EAAkBD,KAAK,CAALA,KAAlB,IAAP,CAAT,CACA,OACD,CAEDE,SAAS,CAAC,SAAAD,MAAM,0BAAUA,MAAV,EAAkBD,KAAK,CAAE,IAAzB,IAAP,CAAT,CAEAL,MAAM,GACNC,QAAQ,CAACK,MAAM,CAACF,OAAR,CAAR,CACD,CAbD,CAeA,GAAMyB,CAAAA,YAAY,CAAGvB,MAAM,CAACD,KAA5B,CAEA,MACE,6BAAM,QAAQ,CAAEsB,YAAhB,EACE,kCAIE,KAAK,CAAC,QAJR,MAEqB,EAAIxC,EAFzB,EAME,oBAAC,SAAD,EACE,IAAI,CAAC,QADP,CAEE,IAAI,KAFN,CAGE,QAAQ,CAAE+B,kBAHZ,CAIE,OAAO,CAAE,yBAAMP,CAAAA,cAAc,CAAC,IAAD,CAApB,EAJX,CAKE,MAAM,CAAE,wBAAMA,CAAAA,cAAc,CAAC,KAAD,CAApB,EALV,CAME,KAAK,CAAEL,MAAM,CAACH,KANhB,CAOE,GAAG,CAAEO,QAPP,CAQE,QAAQ,KARV,CASE,SAAS,CACP,uCAKE,OAAO,CAAEc,sBALX,OAEoB,EAAIrC,EAFxB,OAGaqB,KAAK,CAACsB,MAHnB,QAVJ,CAoBE,iBAAiB,CAAC,KApBpB,EANF,CADF,CA8BGD,YAAY,EACX,iCAIE,IAAI,CAAC,OAJP,OAEqB,EAAI1C,EAFzB,EAMG0C,YANH,CA/BJ,CAwCE,mCAIE,KAAK,CAAE/B,WAJT,CAKE,IAAI,CAAC,QALP,CAME,IAAI,CAAC,QANP,CAOE,IAAI,KAPN,OAEqB,EAAIX,EAFzB,EAxCF,CADF,CAoDD,CAnJe,CAAhB,CAqJA,cAAeS,CAAAA,OAAf","sourcesContent":["import React, { useCallback, useState } from 'react'\nimport {\n  Button,\n  ButtonBase,\n  Field,\n  GU,\n  Info,\n  TextInput,\n  useSidePanelFocusOnReady,\n  useTheme,\n} from '@aragon/ui'\n\nimport { useCourtConfig } from '../../../providers/CourtConfig'\nimport { parseUnits, formatUnits, bigNum } from '../../../lib/math-utils'\n\nconst ANJForm = React.memo(function ANJForm({\n  actionLabel,\n  maxAmount,\n  onDone,\n  onSubmit,\n  runParentValidation,\n}) {\n  const [amount, setAmount] = useState({\n    value: '0',\n    valueBN: bigNum(0),\n    error: null,\n  })\n  const theme = useTheme()\n  const { anjToken } = useCourtConfig()\n  const inputRef = useSidePanelFocusOnReady()\n\n  const handleEditMode = useCallback(\n    editMode => {\n      setAmount(amount => ({\n        ...amount,\n        value: formatUnits(amount.valueBN, {\n          digits: anjToken.decimals,\n          commas: !editMode,\n          replaceZeroBy: editMode ? '' : '0',\n          precision: anjToken.decimals,\n        }),\n      }))\n    },\n    [anjToken.decimals]\n  )\n\n  // Change amount handler\n  const handleAmountChange = useCallback(\n    event => {\n      const newAmount = event.target.value\n      let newAmountBN\n\n      try {\n        newAmountBN = parseUnits(newAmount, anjToken.decimals)\n      } catch (err) {\n        newAmountBN = bigNum(-1)\n      }\n\n      setAmount(amount => ({\n        ...amount,\n        value: newAmount,\n        valueBN: newAmountBN,\n      }))\n    },\n    [anjToken.decimals]\n  )\n\n  // Max value selection handler\n  const handleOnSelectMaxValue = useCallback(() => {\n    setAmount(amount => ({\n      ...amount,\n      value: formatUnits(maxAmount, {\n        digits: anjToken.decimals,\n        precision: anjToken.decimals,\n      }),\n      valueBN: maxAmount,\n    }))\n  }, [anjToken.decimals, maxAmount])\n\n  // Form validation\n  const validateForm = useCallback(() => {\n    if (amount.valueBN.eq(0)) {\n      return 'Amount must not be zero'\n    }\n\n    if (amount.valueBN.eq(-1)) {\n      return 'Wrong amount format'\n    }\n\n    return runParentValidation(amount.valueBN)\n  }, [amount.valueBN, runParentValidation])\n\n  // Form submit\n  const handleSubmit = event => {\n    event.preventDefault()\n\n    const error = validateForm(amount.valueBN)\n    if (error) {\n      setAmount(amount => ({ ...amount, error }))\n      return\n    }\n\n    setAmount(amount => ({ ...amount, error: null }))\n\n    onDone()\n    onSubmit(amount.valueBN)\n  }\n\n  const errorMessage = amount.error\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <Field\n        css={`\n          margin-bottom: ${2 * GU}px;\n        `}\n        label=\"Amount\"\n      >\n        <TextInput\n          name=\"amount\"\n          wide\n          onChange={handleAmountChange}\n          onFocus={() => handleEditMode(true)}\n          onBlur={() => handleEditMode(false)}\n          value={amount.value}\n          ref={inputRef}\n          required\n          adornment={\n            <ButtonBase\n              css={`\n                margin-right: ${1 * GU}px;\n                color: ${theme.accent};\n              `}\n              onClick={handleOnSelectMaxValue}\n            >\n              MAX\n            </ButtonBase>\n          }\n          adornmentPosition=\"end\"\n        />\n      </Field>\n      {errorMessage && (\n        <Info\n          css={`\n            margin-bottom: ${2 * GU}px;\n          `}\n          mode=\"error\"\n        >\n          {errorMessage}\n        </Info>\n      )}\n      <Button\n        css={`\n          margin-bottom: ${1 * GU}px;\n        `}\n        label={actionLabel}\n        mode=\"strong\"\n        type=\"submit\"\n        wide\n      />\n    </form>\n  )\n})\n\nexport default ANJForm\n"]},"metadata":{},"sourceType":"module"}