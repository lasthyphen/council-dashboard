{"ast":null,"code":"import _slicedToArray from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled2 from\"styled-components\";import _styled from\"styled-components\";import React,{useCallback,useEffect,useState}from'react';import{Button,Field,GU,Info,TextInput}from'@aragon/ui';import{useWallet}from'../../../providers/Wallet';import{getJurorDraft}from'../../../utils/juror-draft-utils';import{getDisputeLastRound}from'../../../utils/dispute-utils';import{getCodeFromLocalStorage,getOutcomeFromCommitment,isValidOutcome}from'../../../utils/crvoting-utils';var _StyledTextInput=_styled(TextInput).withConfig({displayName:\"RevealPanel___StyledTextInput\",componentId:\"sc-12i709o-0\"})([\"height:\",\"px;\"],function(p){return p._css;});var _StyledInfo=_styled(Info).withConfig({displayName:\"RevealPanel___StyledInfo\",componentId:\"sc-12i709o-1\"})([\"margin-bottom:\",\"px;\"],function(p){return p._css2;});var RevealPanel=React.memo(function RevealPanel(_ref){var dispute=_ref.dispute,onDone=_ref.onDone,onReveal=_ref.onReveal;var wallet=useWallet();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var lastRound=getDisputeLastRound(dispute);var jurorDraft=getJurorDraft(lastRound,wallet.account);var handlePasswordChange=useCallback(function(event){setError(null);setPassword(event.target.value);},[]);var validatePassword=useCallback(function(){var outcome=getOutcomeFromCommitment(jurorDraft.commitment,password);if(!isValidOutcome(outcome)){return{error:'Invalid one time code'};}return{outcome:outcome};},[jurorDraft.commitment,password]);var handleReveal=useCallback(function(event){event.preventDefault();var _validatePassword=validatePassword(),outcome=_validatePassword.outcome,error=_validatePassword.error;if(error){return setError(error);}onDone();onReveal(dispute.id,dispute.lastRoundId,wallet.account,outcome,password);},[dispute.id,dispute.lastRoundId,onDone,onReveal,password,validatePassword,wallet.account]);useEffect(function(){var oneTimeCode=getCodeFromLocalStorage(wallet.account,dispute.id);if(oneTimeCode){setPassword(oneTimeCode);}},[dispute.id,wallet.account]);return React.createElement(\"form\",{onSubmit:handleReveal},React.createElement(Field,{label:\"One-time-use code\"},React.createElement(_StyledTextInput,{value:password,multiline:true,wide:true,onChange:handlePasswordChange,_css:11*GU})),error&&React.createElement(_StyledInfo,{mode:\"error\",_css2:2*GU},error),React.createElement(Button,{type:\"submit\",wide:true,mode:\"strong\"},\"Reveal your vote\"));});export default RevealPanel;","map":{"version":3,"sources":["/Users/saleemfareed/oneds/court-dashboard/src/components/Disputes/panels/RevealPanel.js"],"names":["React","useCallback","useEffect","useState","Button","Field","GU","Info","TextInput","useWallet","getJurorDraft","getDisputeLastRound","getCodeFromLocalStorage","getOutcomeFromCommitment","isValidOutcome","RevealPanel","memo","dispute","onDone","onReveal","wallet","error","setError","password","setPassword","lastRound","jurorDraft","account","handlePasswordChange","event","target","value","validatePassword","outcome","commitment","handleReveal","preventDefault","id","lastRoundId","oneTimeCode"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react'\nimport { Button, Field, GU, Info, TextInput } from '@aragon/ui'\nimport { useWallet } from '../../../providers/Wallet'\nimport { getJurorDraft } from '../../../utils/juror-draft-utils'\nimport { getDisputeLastRound } from '../../../utils/dispute-utils'\nimport {\n  getCodeFromLocalStorage,\n  getOutcomeFromCommitment,\n  isValidOutcome,\n} from '../../../utils/crvoting-utils'\n\nconst RevealPanel = React.memo(function RevealPanel({\n  dispute,\n  onDone,\n  onReveal,\n}) {\n  const wallet = useWallet()\n  const [error, setError] = useState(null)\n  const [password, setPassword] = useState('')\n  const lastRound = getDisputeLastRound(dispute)\n\n  const jurorDraft = getJurorDraft(lastRound, wallet.account)\n\n  const handlePasswordChange = useCallback(event => {\n    setError(null)\n    setPassword(event.target.value)\n  }, [])\n\n  const validatePassword = useCallback(() => {\n    const outcome = getOutcomeFromCommitment(jurorDraft.commitment, password)\n    if (!isValidOutcome(outcome)) {\n      return { error: 'Invalid one time code' }\n    }\n\n    return { outcome }\n  }, [jurorDraft.commitment, password])\n\n  const handleReveal = useCallback(\n    event => {\n      event.preventDefault()\n\n      const { outcome, error } = validatePassword()\n      if (error) {\n        return setError(error)\n      }\n\n      onDone()\n      onReveal(\n        dispute.id,\n        dispute.lastRoundId,\n        wallet.account,\n        outcome,\n        password\n      )\n    },\n    [\n      dispute.id,\n      dispute.lastRoundId,\n      onDone,\n      onReveal,\n      password,\n      validatePassword,\n      wallet.account,\n    ]\n  )\n\n  useEffect(() => {\n    const oneTimeCode = getCodeFromLocalStorage(wallet.account, dispute.id)\n    if (oneTimeCode) {\n      setPassword(oneTimeCode)\n    }\n  }, [dispute.id, wallet.account])\n\n  return (\n    <form onSubmit={handleReveal}>\n      <Field label=\"One-time-use code\">\n        <TextInput\n          value={password}\n          css={`\n            height: ${11 * GU}px;\n          `}\n          multiline\n          wide\n          onChange={handlePasswordChange}\n        />\n      </Field>\n      {error && (\n        <Info\n          css={`\n            margin-bottom: ${2 * GU}px;\n          `}\n          mode=\"error\"\n        >\n          {error}\n        </Info>\n      )}\n      <Button type=\"submit\" wide mode=\"strong\">\n        Reveal your vote\n      </Button>\n    </form>\n  )\n})\n\nexport default RevealPanel\n"]},"metadata":{},"sourceType":"module"}