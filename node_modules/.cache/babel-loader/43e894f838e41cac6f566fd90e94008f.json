{"ast":null,"code":"import _classCallCheck from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/inherits\";import _defineProperty from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React from'react';import{captureException,showReportDialog}from'@sentry/browser';import GenericError from'./components/Errors/GenericError';import GlobalErrorScreen from'./components/Errors/GlobalErrorScreen';import DisputeNotFoundError from'./components/Disputes/DisputeNotFoundError';import{DisputeNotFound}from'./errors';import{sentryEnabled}from'./sentry';var GlobalErrorHandler=/*#__PURE__*/function(_React$Component){_inherits(GlobalErrorHandler,_React$Component);function GlobalErrorHandler(){var _getPrototypeOf2;var _this;_classCallCheck(this,GlobalErrorHandler);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(GlobalErrorHandler)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),\"state\",{error:null,errorStack:null});_defineProperty(_assertThisInitialized(_this),\"handleReportClick\",function(){if(sentryEnabled){var eventId=captureException(_this.state.error);showReportDialog({eventId:eventId});}});_defineProperty(_assertThisInitialized(_this),\"handleHashchange\",function(){window.location.reload();});return _this;}_createClass(GlobalErrorHandler,[{key:\"componentDidCatch\",value:function componentDidCatch(error,errorInfo){this.setState({error:error,errorStack:errorInfo.componentStack.replace(/^\\n+|\\n+$/g,'').replace(/^ {4}/gm,'')});// Once this point is reached, the app can not recover because the routing\n// system, being below this component in the tree, is not functional\n// anymore. To make hash changes work despite this (e.g. by pressing the\n// back button in the browser), the page need to be reloaded.\nwindow.removeEventListener('hashchange',this.handleHashchange);window.addEventListener('hashchange',this.handleHashchange);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('hashchange',this.handleHashchange);}},{key:\"render\",value:function render(){var children=this.props.children;var _this$state=this.state,error=_this$state.error,errorStack=_this$state.errorStack;return error?React.createElement(GlobalErrorScreen,null,error instanceof DisputeNotFound?React.createElement(DisputeNotFoundError,{disputeId:error.disputeId}):React.createElement(GenericError,{detailsTitle:error.message,detailsContent:errorStack,reportCallback:this.handleReportClick})):children;}}]);return GlobalErrorHandler;}(React.Component);export default GlobalErrorHandler;","map":{"version":3,"sources":["/Users/saleemfareed/oneds/court-dashboard/src/GlobalErrorHandler.js"],"names":["React","captureException","showReportDialog","GenericError","GlobalErrorScreen","DisputeNotFoundError","DisputeNotFound","sentryEnabled","GlobalErrorHandler","error","errorStack","eventId","state","window","location","reload","errorInfo","setState","componentStack","replace","removeEventListener","handleHashchange","addEventListener","children","props","disputeId","message","handleReportClick","Component"],"mappings":"o4BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,OAASC,gBAAT,CAA2BC,gBAA3B,KAAmD,iBAAnD,CACA,MAAOC,CAAAA,YAAP,KAAyB,kCAAzB,CACA,MAAOC,CAAAA,iBAAP,KAA8B,uCAA9B,CACA,MAAOC,CAAAA,oBAAP,KAAiC,4CAAjC,CAEA,OAASC,eAAT,KAAgC,UAAhC,CACA,OAASC,aAAT,KAA8B,UAA9B,C,GAEMC,CAAAA,kB,2eAKI,CAAEC,KAAK,CAAE,IAAT,CAAeC,UAAU,CAAE,IAA3B,C,oEAsBY,UAAM,CACxB,GAAIH,aAAJ,CAAmB,CACjB,GAAMI,CAAAA,OAAO,CAAGV,gBAAgB,CAAC,MAAKW,KAAL,CAAWH,KAAZ,CAAhC,CACAP,gBAAgB,CAAC,CAAES,OAAO,CAAPA,OAAF,CAAD,CAAhB,CACD,CACF,C,mEAEkB,UAAM,CACvBE,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACD,C,2GA7BiBN,K,CAAOO,S,CAAW,CAClC,KAAKC,QAAL,CAAc,CACZR,KAAK,CAALA,KADY,CAEZC,UAAU,CAAEM,SAAS,CAACE,cAAV,CACTC,OADS,CACD,YADC,CACa,EADb,EAETA,OAFS,CAED,SAFC,CAEU,EAFV,CAFA,CAAd,EAOA;AACA;AACA;AACA;AACAN,MAAM,CAACO,mBAAP,CAA2B,YAA3B,CAAyC,KAAKC,gBAA9C,EACAR,MAAM,CAACS,gBAAP,CAAwB,YAAxB,CAAsC,KAAKD,gBAA3C,EACD,C,mEAEsB,CACrBR,MAAM,CAACO,mBAAP,CAA2B,YAA3B,CAAyC,KAAKC,gBAA9C,EACD,C,uCAaQ,IACCE,CAAAA,QADD,CACc,KAAKC,KADnB,CACCD,QADD,iBAEuB,KAAKX,KAF5B,CAECH,KAFD,aAECA,KAFD,CAEQC,UAFR,aAEQA,UAFR,CAIP,MAAOD,CAAAA,KAAK,CACV,oBAAC,iBAAD,MACGA,KAAK,WAAYH,CAAAA,eAAjB,CACC,oBAAC,oBAAD,EAAsB,SAAS,CAAEG,KAAK,CAACgB,SAAvC,EADD,CAGC,oBAAC,YAAD,EACE,YAAY,CAAEhB,KAAK,CAACiB,OADtB,CAEE,cAAc,CAAEhB,UAFlB,CAGE,cAAc,CAAE,KAAKiB,iBAHvB,EAJJ,CADU,CAaVJ,QAbF,CAeD,C,gCAzD8BvB,KAAK,CAAC4B,S,EA4DvC,cAAepB,CAAAA,kBAAf","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { captureException, showReportDialog } from '@sentry/browser'\nimport GenericError from './components/Errors/GenericError'\nimport GlobalErrorScreen from './components/Errors/GlobalErrorScreen'\nimport DisputeNotFoundError from './components/Disputes/DisputeNotFoundError'\n\nimport { DisputeNotFound } from './errors'\nimport { sentryEnabled } from './sentry'\n\nclass GlobalErrorHandler extends React.Component {\n  static propTypes = {\n    children: PropTypes.node,\n  }\n\n  state = { error: null, errorStack: null }\n\n  componentDidCatch(error, errorInfo) {\n    this.setState({\n      error,\n      errorStack: errorInfo.componentStack\n        .replace(/^\\n+|\\n+$/g, '')\n        .replace(/^ {4}/gm, ''),\n    })\n\n    // Once this point is reached, the app can not recover because the routing\n    // system, being below this component in the tree, is not functional\n    // anymore. To make hash changes work despite this (e.g. by pressing the\n    // back button in the browser), the page need to be reloaded.\n    window.removeEventListener('hashchange', this.handleHashchange)\n    window.addEventListener('hashchange', this.handleHashchange)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('hashchange', this.handleHashchange)\n  }\n\n  handleReportClick = () => {\n    if (sentryEnabled) {\n      const eventId = captureException(this.state.error)\n      showReportDialog({ eventId })\n    }\n  }\n\n  handleHashchange = () => {\n    window.location.reload()\n  }\n\n  render() {\n    const { children } = this.props\n    const { error, errorStack } = this.state\n\n    return error ? (\n      <GlobalErrorScreen>\n        {error instanceof DisputeNotFound ? (\n          <DisputeNotFoundError disputeId={error.disputeId} />\n        ) : (\n          <GenericError\n            detailsTitle={error.message}\n            detailsContent={errorStack}\n            reportCallback={this.handleReportClick}\n          />\n        )}\n      </GlobalErrorScreen>\n    ) : (\n      children\n    )\n  }\n}\n\nexport default GlobalErrorHandler\n"]},"metadata":{},"sourceType":"module"}