{"ast":null,"code":"import _styled17 from\"styled-components\";import _styled16 from\"styled-components\";import _styled15 from\"styled-components\";import _styled14 from\"styled-components\";import _styled13 from\"styled-components\";import _styled12 from\"styled-components\";import _styled11 from\"styled-components\";import _styled10 from\"styled-components\";import _styled9 from\"styled-components\";import _styled8 from\"styled-components\";import _styled7 from\"styled-components\";import _styled6 from\"styled-components\";import _styled5 from\"styled-components\";import _styled4 from\"styled-components\";import _styled3 from\"styled-components\";import _styled2 from\"styled-components\";import _styled from\"styled-components\";import React,{useMemo}from'react';import{Button,GU,Help,textStyle,useTheme}from'@aragon/ui';import{animated,useSpring}from'react-spring';import Loading from'../Loading';import ANJLockedDistribution from'./ANJLockedDistribution';import SplitAmount from'../SplitAmount';import{useCourtConfig}from'../../providers/CourtConfig';import{useANJAmountToUsd}from'../../hooks/useTokenAmountToUsd';import{PCT_BASE}from'../../utils/dispute-utils';import{bigNum,formatTokenAmount,formatUnits}from'../../lib/math-utils';import{movementDirection,convertToString}from'../../types/anj-types';import ANJIcon from\"../../assets/IconANJ.svg\";import lockIcon from\"../../assets/IconLock.svg\";var _StyledDiv=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv\",componentId:\"sc-1qf2im8-0\"})([\"border-bottom:1px solid \",\";\"],function(p){return p._css;});var _StyledAnimatedDiv=_styled(animated.div).withConfig({displayName:\"Balance___StyledAnimatedDiv\",componentId:\"sc-1qf2im8-1\"})([\"display:flex;align-items:flex-start;padding-bottom:\",\"px;\"],function(p){return p._css2;});var _StyledDiv2=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv2\",componentId:\"sc-1qf2im8-2\"})([\"padding:\",\"px;background:\",\";border-radius:50%;margin-right:\",\"px;\"],function(p){return p._css3;},function(p){return p._css4;},function(p){return p._css5;});var _StyledImg=_styled(\"img\").withConfig({displayName:\"Balance___StyledImg\",componentId:\"sc-1qf2im8-3\"})([\"display:block;\"]);var _StyledSpan=_styled(\"span\").withConfig({displayName:\"Balance___StyledSpan\",componentId:\"sc-1qf2im8-4\"})([\"       \",\" color:\",\";display:block;\"],function(p){return p._css6;},function(p){return p._css7;});var _StyledDiv3=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv3\",componentId:\"sc-1qf2im8-5\"})([\"\",\" line-height:1.2;display:flex;align-items:center;\"],function(p){return p._css8;});var _StyledSpan2=_styled(\"span\").withConfig({displayName:\"Balance___StyledSpan2\",componentId:\"sc-1qf2im8-6\"})([\"\",\" color:\",\";display:block;\"],function(p){return p._css9;},function(p){return p._css10;});var _StyledDiv4=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv4\",componentId:\"sc-1qf2im8-7\"})([\"height:96px;\"]);var _StyledDiv5=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv5\",componentId:\"sc-1qf2im8-8\"})([\"margin:\",\"px 0;color:\",\";\"],function(p){return p._css11;},function(p){return p._css12;});var _StyledDiv6=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv6\",componentId:\"sc-1qf2im8-9\"})([\"display:grid;grid-template-columns:repeat( auto-fit,minmax(calc(50% - 8px),1fr) );grid-column-gap:8px;\"]);var Balance=React.memo(function Balance(_ref){var label=_ref.label,amount=_ref.amount,loading=_ref.loading,actions=_ref.actions,mainIcon=_ref.mainIcon,activity=_ref.activity,distribution=_ref.distribution,mainIconBackground=_ref.mainIconBackground;var theme=useTheme();var _useCourtConfig=useCourtConfig(),_useCourtConfig$anjTo=_useCourtConfig.anjToken,symbol=_useCourtConfig$anjTo.symbol,decimals=_useCourtConfig$anjTo.decimals;var convertedAmount=useANJAmountToUsd(amount);var springProps=useSpring({to:{opacity:1},from:{opacity:0},delay:300});return React.createElement(\"div\",null,React.createElement(_StyledDiv,{_css:theme.border.alpha(0.7)},loading?React.createElement(Loading,{height:86,size:\"large\"}):React.createElement(_StyledAnimatedDiv,{style:springProps,_css2:2*GU},React.createElement(_StyledDiv2,{_css3:1.5*GU,_css4:mainIconBackground,_css5:2*GU},React.createElement(_StyledImg,{src:mainIcon,height:3*GU,width:3*GU})),React.createElement(\"div\",null,React.createElement(_StyledSpan,{_css6:textStyle('body2'),_css7:theme.surfaceContentSecondary},label),React.createElement(_StyledDiv3,{_css8:textStyle('title3')},React.createElement(SplitAmount,{amount:formatUnits(amount,{digits:decimals})}),React.createElement(\"img\",{height:\"20\",width:\"18\",src:ANJIcon,alt:\"ANJ\"})),React.createElement(_StyledSpan2,{_css9:textStyle('body4'),_css10:theme.surfaceContentSecondary},\"$ \",convertedAmount)))),loading?React.createElement(_StyledDiv4,null):React.createElement(animated.div,{style:springProps},React.createElement(_StyledDiv5,{_css11:2*GU,_css12:theme.surfaceContentSecondary},activity?React.createElement(LatestActivity,{activity:activity,tokenSymbol:symbol,distribution:distribution}):React.createElement(\"span\",null,\"No activity in the last 24h\")),React.createElement(_StyledDiv6,null,actions.map(function(action,index){return React.createElement(Button,{key:index,label:action.label,mode:action.mode,onClick:action.onClick,wide:true,disabled:amount.eq(0)});}))));});var _StyledDiv7=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv7\",componentId:\"sc-1qf2im8-10\"})([\"display:flex;justify-content:space-between;\"]);var _StyledDiv8=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv8\",componentId:\"sc-1qf2im8-11\"})([\"display:flex;align-items:center;\"]);var _StyledImg2=_styled(\"img\").withConfig({displayName:\"Balance___StyledImg2\",componentId:\"sc-1qf2im8-12\"})([\"margin-right:\",\"px;\"],function(p){return p._css13;});var _StyledSpan3=_styled(\"span\").withConfig({displayName:\"Balance___StyledSpan3\",componentId:\"sc-1qf2im8-13\"})([\"color:\",\";margin-right:\",\"px;\"],function(p){return p._css14;},function(p){return p._css15;});var _StyledSpan4=_styled(\"span\").withConfig({displayName:\"Balance___StyledSpan4\",componentId:\"sc-1qf2im8-14\"})([\"color:\",\";\"],function(p){return p._css16;});var LatestActivity=function LatestActivity(_ref2){var activity=_ref2.activity,distribution=_ref2.distribution;var theme=useTheme();var _useCourtConfig2=useCourtConfig(),anjToken=_useCourtConfig2.anjToken;var isIncoming=activity.direction===movementDirection.Incoming;var displaySign=activity.direction===movementDirection.Incoming||activity.direction===movementDirection.Outgoing;var color=theme.contentSecondary;// If sign shouldn't be displayed it means it's a Locked movement\nif(displaySign)color=isIncoming?theme.positive:theme.negative;return React.createElement(_StyledDiv7,null,React.createElement(_StyledDiv8,null,!displaySign&&React.createElement(_StyledImg2,{src:lockIcon,alt:\"lock\",width:\"12px\",height:\"14px\",_css13:0.5*GU}),React.createElement(_StyledSpan3,{_css14:color,_css15:0.5*GU},formatTokenAmount(activity.amount,isIncoming,anjToken.decimals,displaySign),' ',anjToken.symbol),React.createElement(_StyledSpan4,{_css16:theme.content},convertToString(activity.type,activity.direction))),distribution&&React.createElement(ANJLockedHelp,{distribution:distribution}));};var _StyledDiv9=_styled(\"div\").withConfig({displayName:\"Balance___StyledDiv9\",componentId:\"sc-1qf2im8-15\"})([\"display:flex;align-items:center;\"]);var _StyledSpan5=_styled(\"span\").withConfig({displayName:\"Balance___StyledSpan5\",componentId:\"sc-1qf2im8-16\"})([\"color:\",\";margin-right:\",\"px;\"],function(p){return p._css17;},function(p){return p._css18;});var ANJLockedHelp=function ANJLockedHelp(_ref3){var distribution=_ref3.distribution;var theme=useTheme();var _useHelpAttributes=useHelpAttributes(distribution),showDistribution=_useHelpAttributes.showDistribution,text=_useHelpAttributes.text;var hintText=\"What's my ANJ distribution\";if(!showDistribution){hintText=distribution.inProcess.gt(0)?'Why is my ANJ being deactivated':'Why is my balance locked';}return React.createElement(_StyledDiv9,null,React.createElement(_StyledSpan5,{_css17:theme.help,_css18:0.5*GU},showDistribution?'ANJ Distribution ':'Why'),React.createElement(Help,{hint:hintText},showDistribution?React.createElement(ANJLockedDistribution,{distribution:distribution,text:text}):text));};function useHelpAttributes(distribution){var _useCourtConfig3=useCourtConfig(),anjToken=_useCourtConfig3.anjToken,minActiveBalance=_useCourtConfig3.minActiveBalance,penaltyPct=_useCourtConfig3.penaltyPct;return useMemo(function(){if(distribution.inProcess.gt(0)){return{showDistribution:!!distribution.lockedPerDispute,// If juror has  ANJ locked in disputes, we'll show distribution\ntext:'Deactivating ANJ does not happen immediately and requires one term before it can be processed.'};}var lockedPerDispute=distribution.lockedPerDispute;var onlyOneDispute=lockedPerDispute.length===1;var isJurorDraftedMultipleTimesSameDispute=lockedPerDispute.some(function(lock){return lock.weight.gt(1);});var text;var decimals=anjToken.decimals,symbol=anjToken.symbol;var penaltyPercentage=bigNum(penaltyPct).div(PCT_BASE.div(100));var minActiveBalanceFormatted=formatUnits(minActiveBalance,{digits:decimals});var minLockedAmountFormatted=formatUnits(minActiveBalance.mul(penaltyPct).div(PCT_BASE),{digits:decimals});if(isJurorDraftedMultipleTimesSameDispute){text='The same juror can be drafted multiple times to arbitrate the same dispute for the same round.  When that happens, their voting weight will be proportional to the number of times they are drafted, as well as the % of ANJ locked in the Active balance.';}else{text=onlyOneDispute?\"A portion of your active ANJ has been locked because you were drafted in a dispute. This amount will be locked until the dispute has been resolved. The exact locked amount corresponds to the \".concat(penaltyPercentage,\"% of the minimum active balance for each time you get drafted. The minimum active balance is currently \").concat(minActiveBalanceFormatted,\" \").concat(symbol,\", therefore the amount locked would be \").concat(minLockedAmountFormatted,\" ANJ.\"):'';}return{text:text,showDistribution:!onlyOneDispute||isJurorDraftedMultipleTimesSameDispute};},[anjToken,distribution,minActiveBalance,penaltyPct]);}export default Balance;","map":{"version":3,"sources":["/Users/saleemfareed/oneds/court-dashboard/src/components/Dashboard/Balance.js"],"names":["React","useMemo","Button","GU","Help","textStyle","useTheme","animated","useSpring","Loading","ANJLockedDistribution","SplitAmount","useCourtConfig","useANJAmountToUsd","PCT_BASE","bigNum","formatTokenAmount","formatUnits","movementDirection","convertToString","Balance","memo","label","amount","loading","actions","mainIcon","activity","distribution","mainIconBackground","theme","anjToken","symbol","decimals","convertedAmount","springProps","to","opacity","from","delay","border","alpha","surfaceContentSecondary","digits","ANJIcon","map","action","index","mode","onClick","eq","LatestActivity","isIncoming","direction","Incoming","displaySign","Outgoing","color","contentSecondary","positive","negative","lockIcon","content","type","ANJLockedHelp","useHelpAttributes","showDistribution","text","hintText","inProcess","gt","help","minActiveBalance","penaltyPct","lockedPerDispute","onlyOneDispute","length","isJurorDraftedMultipleTimesSameDispute","some","lock","weight","penaltyPercentage","div","minActiveBalanceFormatted","minLockedAmountFormatted","mul"],"mappings":"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","sourcesContent":["import React, { useMemo } from 'react'\nimport { Button, GU, Help, textStyle, useTheme } from '@aragon/ui'\nimport { animated, useSpring } from 'react-spring'\n\nimport Loading from '../Loading'\nimport ANJLockedDistribution from './ANJLockedDistribution'\nimport SplitAmount from '../SplitAmount'\n\nimport { useCourtConfig } from '../../providers/CourtConfig'\nimport { useANJAmountToUsd } from '../../hooks/useTokenAmountToUsd'\n\nimport { PCT_BASE } from '../../utils/dispute-utils'\nimport { bigNum, formatTokenAmount, formatUnits } from '../../lib/math-utils'\nimport { movementDirection, convertToString } from '../../types/anj-types'\n\nimport ANJIcon from '../../assets/IconANJ.svg'\nimport lockIcon from '../../assets/IconLock.svg'\n\nconst Balance = React.memo(function Balance({\n  label,\n  amount,\n  loading,\n  actions,\n  mainIcon,\n  activity,\n  distribution,\n  mainIconBackground,\n}) {\n  const theme = useTheme()\n  const {\n    anjToken: { symbol, decimals },\n  } = useCourtConfig()\n\n  const convertedAmount = useANJAmountToUsd(amount)\n\n  const springProps = useSpring({\n    to: { opacity: 1 },\n    from: { opacity: 0 },\n    delay: 300,\n  })\n\n  return (\n    <div>\n      <div\n        css={`\n          border-bottom: 1px solid ${theme.border.alpha(0.7)};\n        `}\n      >\n        {loading ? (\n          <Loading height={86} size=\"large\" />\n        ) : (\n          <animated.div\n            style={springProps}\n            css={`\n              display: flex;\n              align-items: flex-start;\n              padding-bottom: ${2 * GU}px;\n            `}\n          >\n            <div\n              css={`\n                padding: ${1.5 * GU}px;\n                background: ${mainIconBackground};\n                border-radius: 50%;\n                margin-right: ${2 * GU}px;\n              `}\n            >\n              <img\n                css={`\n                  display: block;\n                `}\n                src={mainIcon}\n                height={3 * GU}\n                width={3 * GU}\n              />\n            </div>\n            <div>\n              <span\n                css={`      \n                ${textStyle('body2')}\n                color: ${theme.surfaceContentSecondary};\n                display:block;\n              `}\n              >\n                {label}\n              </span>\n              <div\n                css={`\n                  ${textStyle('title3')}\n                  line-height: 1.2;\n                  display: flex;\n                  align-items: center;\n                `}\n              >\n                <SplitAmount\n                  amount={formatUnits(amount, { digits: decimals })}\n                />\n                <img height=\"20\" width=\"18\" src={ANJIcon} alt=\"ANJ\" />\n              </div>\n              <span\n                css={`\n                ${textStyle('body4')}\n                color: ${theme.surfaceContentSecondary};\n                display:block;\n              `}\n              >\n                $ {convertedAmount}\n              </span>\n            </div>\n          </animated.div>\n        )}\n      </div>\n      {loading ? (\n        <div\n          css={`\n            height: 96px;\n          `}\n        />\n      ) : (\n        <animated.div style={springProps}>\n          <div\n            css={`\n              margin: ${2 * GU}px 0;\n              color: ${theme.surfaceContentSecondary};\n            `}\n          >\n            {activity ? (\n              <LatestActivity\n                activity={activity}\n                tokenSymbol={symbol}\n                distribution={distribution}\n              />\n            ) : (\n              <span>No activity in the last 24h</span>\n            )}\n          </div>\n          <div\n            css={`\n              display: grid;\n              grid-template-columns: repeat(\n                auto-fit,\n                minmax(calc(50% - 8px), 1fr)\n              );\n              grid-column-gap: 8px;\n            `}\n          >\n            {actions.map((action, index) => {\n              return (\n                <Button\n                  key={index}\n                  label={action.label}\n                  mode={action.mode}\n                  onClick={action.onClick}\n                  wide\n                  disabled={amount.eq(0)}\n                />\n              )\n            })}\n          </div>\n        </animated.div>\n      )}\n    </div>\n  )\n})\n\nconst LatestActivity = ({ activity, distribution }) => {\n  const theme = useTheme()\n  const { anjToken } = useCourtConfig()\n  const isIncoming = activity.direction === movementDirection.Incoming\n  const displaySign =\n    activity.direction === movementDirection.Incoming ||\n    activity.direction === movementDirection.Outgoing\n\n  let color = theme.contentSecondary\n  // If sign shouldn't be displayed it means it's a Locked movement\n  if (displaySign) color = isIncoming ? theme.positive : theme.negative\n\n  return (\n    <div\n      css={`\n        display: flex;\n        justify-content: space-between;\n      `}\n    >\n      <div\n        css={`\n          display: flex;\n          align-items: center;\n        `}\n      >\n        {!displaySign && (\n          <img\n            src={lockIcon}\n            alt=\"lock\"\n            width=\"12px\"\n            height=\"14px\"\n            css={`\n              margin-right: ${0.5 * GU}px;\n            `}\n          />\n        )}\n        <span\n          css={`\n            color: ${color};\n            margin-right: ${0.5 * GU}px;\n          `}\n        >\n          {formatTokenAmount(\n            activity.amount,\n            isIncoming,\n            anjToken.decimals,\n            displaySign\n          )}{' '}\n          {anjToken.symbol}\n        </span>\n        <span\n          css={`\n            color: ${theme.content};\n          `}\n        >\n          {convertToString(activity.type, activity.direction)}\n        </span>\n      </div>\n      {distribution && <ANJLockedHelp distribution={distribution} />}\n    </div>\n  )\n}\n\nconst ANJLockedHelp = ({ distribution }) => {\n  const theme = useTheme()\n\n  const { showDistribution, text } = useHelpAttributes(distribution)\n\n  let hintText = \"What's my ANJ distribution\"\n  if (!showDistribution) {\n    hintText = distribution.inProcess.gt(0)\n      ? 'Why is my ANJ being deactivated'\n      : 'Why is my balance locked'\n  }\n\n  return (\n    <div\n      css={`\n        display: flex;\n        align-items: center;\n      `}\n    >\n      <span\n        css={`\n          color: ${theme.help};\n          margin-right: ${0.5 * GU}px;\n        `}\n      >\n        {showDistribution ? 'ANJ Distribution ' : 'Why'}\n      </span>\n      <Help hint={hintText}>\n        {showDistribution ? (\n          <ANJLockedDistribution distribution={distribution} text={text} />\n        ) : (\n          text\n        )}\n      </Help>\n    </div>\n  )\n}\n\nfunction useHelpAttributes(distribution) {\n  const { anjToken, minActiveBalance, penaltyPct } = useCourtConfig()\n\n  return useMemo(() => {\n    if (distribution.inProcess.gt(0)) {\n      return {\n        showDistribution: !!distribution.lockedPerDispute, // If juror has  ANJ locked in disputes, we'll show distribution\n        text:\n          'Deactivating ANJ does not happen immediately and requires one term before it can be processed.',\n      }\n    }\n\n    const { lockedPerDispute } = distribution\n\n    const onlyOneDispute = lockedPerDispute.length === 1\n    const isJurorDraftedMultipleTimesSameDispute = lockedPerDispute.some(lock =>\n      lock.weight.gt(1)\n    )\n\n    let text\n    const { decimals, symbol } = anjToken\n    const penaltyPercentage = bigNum(penaltyPct).div(PCT_BASE.div(100))\n    const minActiveBalanceFormatted = formatUnits(minActiveBalance, {\n      digits: decimals,\n    })\n    const minLockedAmountFormatted = formatUnits(\n      minActiveBalance.mul(penaltyPct).div(PCT_BASE),\n      { digits: decimals }\n    )\n\n    if (isJurorDraftedMultipleTimesSameDispute) {\n      text =\n        'The same juror can be drafted multiple times to arbitrate the same dispute for the same round.  When that happens, their voting weight will be proportional to the number of times they are drafted, as well as the % of ANJ locked in the Active balance.'\n    } else {\n      text = onlyOneDispute\n        ? `A portion of your active ANJ has been locked because you were drafted in a dispute. This amount will be locked until the dispute has been resolved. The exact locked amount corresponds to the ${penaltyPercentage}% of the minimum active balance for each time you get drafted. The minimum active balance is currently ${minActiveBalanceFormatted} ${symbol}, therefore the amount locked would be ${minLockedAmountFormatted} ANJ.`\n        : ''\n    }\n\n    return {\n      text,\n      showDistribution:\n        !onlyOneDispute || isJurorDraftedMultipleTimesSameDispute,\n    }\n  }, [anjToken, distribution, minActiveBalance, penaltyPct])\n}\n\nexport default Balance\n"]},"metadata":{},"sourceType":"module"}