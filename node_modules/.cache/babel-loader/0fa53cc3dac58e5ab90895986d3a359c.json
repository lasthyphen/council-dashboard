{"ast":null,"code":"import _slicedToArray from\"/Users/saleemfareed/oneds/court-dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled9 from\"styled-components\";import _styled8 from\"styled-components\";import _styled7 from\"styled-components\";import _styled6 from\"styled-components\";import _styled5 from\"styled-components\";import _styled4 from\"styled-components\";import _styled3 from\"styled-components\";import _styled2 from\"styled-components\";import _styled from\"styled-components\";import React from'react';import{animated,useSpring}from'react-spring';import{GU,Help,LoadingRing,useTheme}from'@aragon/ui';import AccountBannerInfo from'./AccountBannerInfo';import CircleGraph from'../CircleGraph';import{useCourtConfig}from'../../providers/CourtConfig';import{useTotalActiveBalance}from'../../hooks/useCourtStats';import{useJurorFirstTimeANJActivation}from'../../hooks/useANJ';import{ACCOUNT_STATUS_JUROR_ACTIVE}from'../../types/account-status-types';import{getPercentageBN,bigNum}from'../../lib/math-utils';import anjSpringIcon from\"../../assets/IconANJSpring.svg\";import{useJurorDrafted}from'../../hooks/useJurorDrafted';var getBannerAttributes=function getBannerAttributes(){return{icon:anjSpringIcon,title:'Deprecation warning: Council Tokens',paragraph:\"Please do not lose the keys to your Decypher wallet.\"};};var _StyledDiv=_styled(\"div\").withConfig({displayName:\"AccountBanner___StyledDiv\",componentId:\"e2oi7a-0\"})([\"display:flex;align-items:center;justify-content:center;background:\",\";width:\",\";border-radius:50%;\"],function(p){return p._css;},function(p){return p._css2;});var _StyledImg=_styled(\"img\").withConfig({displayName:\"AccountBanner___StyledImg\",componentId:\"e2oi7a-1\"})([\"display:block;margin:0 auto;\"]);function AccountBanner(_ref){var status=_ref.status,loading=_ref.loading,minActiveBalance=_ref.minActiveBalance,activeBalance=_ref.activeBalance;var theme=useTheme();var _useCourtConfig=useCourtConfig(),anjToken=_useCourtConfig.anjToken;// check if juror has been drafted in this current term\nvar isJurorDrafted=useJurorDrafted({pause:status!==ACCOUNT_STATUS_JUROR_ACTIVE});// check if it's the first time activating ANJ\nvar isFirstTimeActivating=useJurorFirstTimeANJActivation({pause:isJurorDrafted||status!==ACCOUNT_STATUS_JUROR_ACTIVE});var attributes=getBannerAttributes(status,isJurorDrafted,isFirstTimeActivating,minActiveBalance,anjToken.decimals,theme);if(loading){return React.createElement(BannerLoadingRing,null);}if(attributes.showProbability){return React.createElement(BannerWithProbability,{activeBalance:activeBalance});}var icon=attributes.icon,title=attributes.title,titleColor=attributes.titleColor,paragraph=attributes.paragraph,iconBackground=attributes.iconBackground,showTimer=attributes.showTimer;return React.createElement(Wrapper,{mainIcon:React.createElement(_StyledDiv,{_css:iconBackground,_css2:iconBackground?7*GU+'px':'auto'},React.createElement(_StyledImg,{height:iconBackground?3*GU:6*GU,src:icon,alt:\"\"})),information:React.createElement(AccountBannerInfo,{title:title,titleColor:titleColor,paragraph:paragraph,showTimer:showTimer})});}var _StyledAnimatedDiv=_styled(animated.div).withConfig({displayName:\"AccountBanner___StyledAnimatedDiv\",componentId:\"e2oi7a-2\"})([\"display:flex;\"]);var _StyledDiv2=_styled(\"div\").withConfig({displayName:\"AccountBanner___StyledDiv2\",componentId:\"e2oi7a-3\"})([\"margin-right:\",\"px;\"],function(p){return p._css3;});var Wrapper=function Wrapper(_ref2){var mainIcon=_ref2.mainIcon,information=_ref2.information;var springProps=useSpring({to:{opacity:1},from:{opacity:0},delay:200});return React.createElement(_StyledAnimatedDiv,{style:springProps},React.createElement(_StyledDiv2,{_css3:1.5*GU},mainIcon),information);};var _StyledDiv3=_styled(\"div\").withConfig({displayName:\"AccountBanner___StyledDiv3\",componentId:\"e2oi7a-4\"})([\"display:flex;align-items:center;\"]);var _StyledSpan=_styled(\"span\").withConfig({displayName:\"AccountBanner___StyledSpan\",componentId:\"e2oi7a-5\"})([\"margin-right:\",\"px;\"],function(p){return p._css4;});var _StyledSpan2=_styled(\"span\").withConfig({displayName:\"AccountBanner___StyledSpan2\",componentId:\"e2oi7a-6\"})([\"color:\",\";\"],function(p){return p._css5;});var _StyledP=_styled(\"p\").withConfig({displayName:\"AccountBanner___StyledP\",componentId:\"e2oi7a-7\"})([\"margin-top:\",\"px;\"],function(p){return p._css6;});var BannerWithProbability=function BannerWithProbability(_ref3){var activeBalance=_ref3.activeBalance;var theme=useTheme();var _useTotalActiveBalanc=useTotalActiveBalance(),_useTotalActiveBalanc2=_slicedToArray(_useTotalActiveBalanc,1),totalActiveBalanceCurrentTerm=_useTotalActiveBalanc2[0];var fetchingTotalBalance=totalActiveBalanceCurrentTerm.eq(bigNum(-1));if(fetchingTotalBalance){return React.createElement(BannerLoadingRing,null);}// Calculate juror's active balance and total active balance for current term\nvar activeAmount=activeBalance.amount,activeAmountNotEffective=activeBalance.amountNotEffective;var activeBalanceCurrentTerm=activeAmount.sub(activeAmountNotEffective);var totalPercentage=getPercentageBN(activeBalanceCurrentTerm,totalActiveBalanceCurrentTerm);// Calculate probability (since the total active balance is asynchronous\n// it can happen that it has not been updated yet when the juror active balance has)\nvar draftingProbability=Math.min(1,totalPercentage/100);var probablilityTooLow=totalPercentage<1;var chances=probablilityTooLow?'100+':totalPercentage>0&&Math.floor(100/totalPercentage);var title=React.createElement(_StyledDiv3,null,React.createElement(_StyledSpan,{_css4:1*GU},'On average, you will be drafted into a jury ',React.createElement(_StyledSpan2,{_css5:theme.accent},\"1 in \",chances,\" times\")),React.createElement(Help,{hint:\"How is the probability calculated?\"},React.createElement(\"p\",null,\"This is a numerical estimate of your likelihood of being selected for arbitration. It\\u2019s calculated by dividing your active ANJ balance against the Court's total active ANJ balance during the current term.\"),React.createElement(_StyledP,{_css6:1*GU},probablilityTooLow?\"\\n                You currently have <1% of all activated ANJ, hence are unlikely\\n                to be drafted unless a dispute goes to the final round or many\\n                disputes are created. Activate more ANJ to increase your chances\\n                of being selected as a juror.\\n              \":\"\\n                You can always activate more ANJ to increase your chances of\\n                being selected as a juror.\\n              \")));var paragraph='The more ANJ you activate, the more likely you will be drafted to arbitrate a dispute';return React.createElement(Wrapper,{mainIcon:React.createElement(CircleGraph,{value:draftingProbability}),information:React.createElement(AccountBannerInfo,{title:title,paragraph:paragraph})});};var _StyledDiv4=_styled(\"div\").withConfig({displayName:\"AccountBanner___StyledDiv4\",componentId:\"e2oi7a-8\"})([\"display:flex;align-items:center;height:\",\"px;\"],function(p){return p._css7;});function BannerLoadingRing(){return React.createElement(_StyledDiv4,{_css7:7*GU},React.createElement(LoadingRing,null));}export default AccountBanner;","map":{"version":3,"sources":["/Users/saleemfareed/oneds/court-dashboard/src/components/Dashboard/AccountBanner.js"],"names":["React","animated","useSpring","GU","Help","LoadingRing","useTheme","AccountBannerInfo","CircleGraph","useCourtConfig","useTotalActiveBalance","useJurorFirstTimeANJActivation","ACCOUNT_STATUS_JUROR_ACTIVE","getPercentageBN","bigNum","useJurorDrafted","getBannerAttributes","icon","anjSpringIcon","title","paragraph","AccountBanner","status","loading","minActiveBalance","activeBalance","theme","anjToken","isJurorDrafted","pause","isFirstTimeActivating","attributes","decimals","showProbability","titleColor","iconBackground","showTimer","Wrapper","mainIcon","information","springProps","to","opacity","from","delay","BannerWithProbability","totalActiveBalanceCurrentTerm","fetchingTotalBalance","eq","activeAmount","amount","activeAmountNotEffective","amountNotEffective","activeBalanceCurrentTerm","sub","totalPercentage","draftingProbability","Math","min","probablilityTooLow","chances","floor","accent","BannerLoadingRing"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { animated, useSpring } from 'react-spring'\nimport { GU, Help, LoadingRing, useTheme } from '@aragon/ui'\n\nimport AccountBannerInfo from './AccountBannerInfo'\nimport CircleGraph from '../CircleGraph'\nimport { useCourtConfig } from '../../providers/CourtConfig'\nimport { useTotalActiveBalance } from '../../hooks/useCourtStats'\nimport { useJurorFirstTimeANJActivation } from '../../hooks/useANJ'\n\nimport { ACCOUNT_STATUS_JUROR_ACTIVE } from '../../types/account-status-types'\nimport { getPercentageBN, bigNum } from '../../lib/math-utils'\n\nimport anjSpringIcon from '../../assets/IconANJSpring.svg'\nimport { useJurorDrafted } from '../../hooks/useJurorDrafted'\n\nconst getBannerAttributes = () => {\n  return {\n    icon: anjSpringIcon,\n    title: 'Deprecation warning: Council Tokens',\n    paragraph: `Please do not lose the keys to your Decypher wallet.`,\n  }\n}\n\nfunction AccountBanner({ status, loading, minActiveBalance, activeBalance }) {\n  const theme = useTheme()\n  const { anjToken } = useCourtConfig()\n\n  // check if juror has been drafted in this current term\n  const isJurorDrafted = useJurorDrafted({\n    pause: status !== ACCOUNT_STATUS_JUROR_ACTIVE,\n  })\n\n  // check if it's the first time activating ANJ\n  const isFirstTimeActivating = useJurorFirstTimeANJActivation({\n    pause: isJurorDrafted || status !== ACCOUNT_STATUS_JUROR_ACTIVE,\n  })\n\n  const attributes = getBannerAttributes(\n    status,\n    isJurorDrafted,\n    isFirstTimeActivating,\n    minActiveBalance,\n    anjToken.decimals,\n    theme\n  )\n\n  if (loading) {\n    return <BannerLoadingRing />\n  }\n  if (attributes.showProbability) {\n    return <BannerWithProbability activeBalance={activeBalance} />\n  }\n  const {\n    icon,\n    title,\n    titleColor,\n    paragraph,\n    iconBackground,\n    showTimer,\n  } = attributes\n\n  return (\n    <Wrapper\n      mainIcon={\n        <div\n          css={`\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            background: ${iconBackground};\n            width: ${iconBackground ? 7 * GU + 'px' : 'auto'};\n            border-radius: 50%;\n          `}\n        >\n          <img\n            css={`\n              display: block;\n              margin: 0 auto;\n            `}\n            height={iconBackground ? 3 * GU : 6 * GU}\n            src={icon}\n            alt=\"\"\n          />\n        </div>\n      }\n      information={\n        <AccountBannerInfo\n          title={title}\n          titleColor={titleColor}\n          paragraph={paragraph}\n          showTimer={showTimer}\n        />\n      }\n    />\n  )\n}\n\nconst Wrapper = ({ mainIcon, information }) => {\n  const springProps = useSpring({\n    to: { opacity: 1 },\n    from: { opacity: 0 },\n    delay: 200,\n  })\n\n  return (\n    <animated.div\n      style={springProps}\n      css={`\n        display: flex;\n      `}\n    >\n      <div\n        css={`\n          margin-right: ${1.5 * GU}px;\n        `}\n      >\n        {mainIcon}\n      </div>\n      {information}\n    </animated.div>\n  )\n}\n\nconst BannerWithProbability = ({ activeBalance }) => {\n  const theme = useTheme()\n  const [totalActiveBalanceCurrentTerm] = useTotalActiveBalance()\n\n  const fetchingTotalBalance = totalActiveBalanceCurrentTerm.eq(bigNum(-1))\n  if (fetchingTotalBalance) {\n    return <BannerLoadingRing />\n  }\n\n  // Calculate juror's active balance and total active balance for current term\n  const {\n    amount: activeAmount,\n    amountNotEffective: activeAmountNotEffective,\n  } = activeBalance\n  const activeBalanceCurrentTerm = activeAmount.sub(activeAmountNotEffective)\n  const totalPercentage = getPercentageBN(\n    activeBalanceCurrentTerm,\n    totalActiveBalanceCurrentTerm\n  )\n\n  // Calculate probability (since the total active balance is asynchronous\n  // it can happen that it has not been updated yet when the juror active balance has)\n  const draftingProbability = Math.min(1, totalPercentage / 100)\n  const probablilityTooLow = totalPercentage < 1\n\n  const chances = probablilityTooLow\n    ? '100+'\n    : totalPercentage > 0 && Math.floor(100 / totalPercentage)\n\n  const title = (\n    <div\n      css={`\n        display: flex;\n        align-items: center;\n      `}\n    >\n      <span\n        css={`\n          margin-right: ${1 * GU}px;\n        `}\n      >\n        {'On average, you will be drafted into a jury '}\n        <span\n          css={`\n            color: ${theme.accent};\n          `}\n        >\n          1 in {chances} times\n        </span>\n      </span>\n      <Help hint=\"How is the probability calculated?\">\n        <p>\n          This is a numerical estimate of your likelihood of being selected for\n          arbitration. Itâ€™s calculated by dividing your active ANJ balance\n          against the Court's total active ANJ balance during the current term.\n        </p>\n        <p\n          css={`\n            margin-top: ${1 * GU}px;\n          `}\n        >\n          {probablilityTooLow\n            ? `\n                You currently have <1% of all activated ANJ, hence are unlikely\n                to be drafted unless a dispute goes to the final round or many\n                disputes are created. Activate more ANJ to increase your chances\n                of being selected as a juror.\n              `\n            : `\n                You can always activate more ANJ to increase your chances of\n                being selected as a juror.\n              `}\n        </p>\n      </Help>\n    </div>\n  )\n\n  const paragraph =\n    'The more ANJ you activate, the more likely you will be drafted to arbitrate a dispute'\n\n  return (\n    <Wrapper\n      mainIcon={<CircleGraph value={draftingProbability} />}\n      information={<AccountBannerInfo title={title} paragraph={paragraph} />}\n    />\n  )\n}\n\nfunction BannerLoadingRing() {\n  return (\n    <div\n      css={`\n        display: flex;\n        align-items: center;\n        height: ${7 * GU}px;\n      `}\n    >\n      <LoadingRing />\n    </div>\n  )\n}\n\nexport default AccountBanner\n"]},"metadata":{},"sourceType":"module"}