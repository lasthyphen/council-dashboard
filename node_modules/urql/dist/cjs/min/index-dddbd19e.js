"use strict";var r=require("wonka"),e=require("graphql");function t(){return(t=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}).apply(this,arguments)}var n=function(r){return"string"==typeof r?new e.GraphQLError(r):"object"==typeof r&&r.message?new e.GraphQLError(r.message,r.nodes,r.source,r.positions,r.path,r,r.extensions||{}):r};function o(){return this.message}var i=function(r){function e(e){var t,o,i,s=e.networkError,a=e.response,u=(e.graphQLErrors||[]).map(n),c=(o=u,i="",void 0!==(t=s)?i="[Network] "+t.message:(void 0!==o&&o.forEach((function(r){i+="[GraphQL] "+r.message+"\n"})),i.trim()));r.call(this,c),this.name="CombinedError",this.message=c,this.graphQLErrors=u,this.networkError=s,this.response=a}return r&&(e.__proto__=r),(e.prototype=Object.create(r&&r.prototype)).constructor=e,e.prototype.toString=o,e}(Error),s=function(r,e){r|=0;for(var t=0,n=0|e.length;t<n;t++)r=(r<<5)+r+e.charCodeAt(t);return r},a=new Set,u=function(r){if(void 0===r)return"";if("number"==typeof r)return isFinite(r)?""+r:"null";if("object"!=typeof r)return JSON.stringify(r);if(null===r)return"null";if(r.toJSON)return r.toJSON();var e="";if(Array.isArray(r)){e="[";for(var t=0,n=r.length;t<n;t++){t>0&&(e+=",");var o=u(r[t]);e+=o.length>0?o:"null"}return e+"]"}if(a.has(r))throw new TypeError("Converting circular structure to JSON");var i=Object.keys(r).sort();a.add(r),e="{";for(var s=0,c=i.length;s<c;s++){var p=i[s],f=u(r[p]);0!==f.length&&(e.length>1&&(e+=","),e+=u(p)+":"+f)}return a.delete(r),e+"}"},c=function(r){return a.clear(),u(r)},p=function(r){return e=r.replace(/[\s,]+/g," ").trim(),s(5381,e)>>>0;var e},f=Object.create(null),l=function(r,e){if(void 0===e&&(e=[]),Array.isArray(r))r.forEach((function(r){l(r,e)}));else if("object"==typeof r&&null!==r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var n=r[t];"__typename"===t&&"string"==typeof n?e.push(n):"object"==typeof n&&null!==n&&l(n,e)}return e};function v(r,e,t){return t.indexOf(r)===e}function h(r){return"Field"===r.kind&&"__typename"===r.name.value}var y=function(r){return void 0!==r.selectionSet&&(r.selectionSet.selections.some(h)?r:t(t({},r),{selectionSet:t(t({},r.selectionSet),{selections:r.selectionSet.selections.concat([{kind:e.Kind.FIELD,name:{kind:e.Kind.NAME,value:"__typename"}}])})}))};exports.CombinedError=i,exports._extends=t,exports.addMetadata=function(r,e){return t(t({},r),{context:t(t({},r.context),{meta:t(t({},r.context.meta),e)})})},exports.collectTypesFromResponse=function(r){return l(r).filter(v)},exports.createRequest=function(r,t){var n,o;return"string"==typeof r?(n=p(r),o=void 0!==f[n]?f[n]:e.parse(r)):void 0!==r.__key?(n=r.__key,o=r):(n=p(e.print(r)),o=void 0!==f[n]?f[n]:r),f[n]=o,o.__key=n,{key:t?s(n,c(t))>>>0:n,query:o,variables:t||{}}},exports.formatDocument=function(r){return e.visit(r,{Field:y,InlineFragment:y})},exports.makeErrorResult=function(r,e,t){return{operation:r,data:void 0,error:new i({networkError:e,response:t}),extensions:void 0}},exports.makeResult=function(r,e,t){return{operation:r,data:e.data,error:Array.isArray(e.errors)?new i({graphQLErrors:e.errors,response:t}):void 0,extensions:"object"==typeof e.extensions&&null!==e.extensions?e.extensions:void 0}},exports.stringifyVariables=c,exports.toSuspenseSource=function(e){return function(t){var n=r.share(e),o=!1,i=!1;if(r.onPush((function(){return o=!0}))(r.takeWhile((function(){return!i}))(n))(t),!o)throw i=!0,t(0),r.toPromise(r.take(1)(n))}},exports.withPromise=function(e){return e.toPromise=function(){return r.toPromise(r.take(1)(e))},e};
