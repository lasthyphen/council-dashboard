{"code":"import { getChainInformation, getKnownChainsIds } from './chains';\r\nfunction isUnwrappedRpcResult(response) {\r\n    return (typeof response === 'object' && response !== null && 'jsonrpc' in response);\r\n}\r\nconst EXPLORER_URL_TYPES = new Map([\r\n    ['block', 'block'],\r\n    ['transaction', 'tx'],\r\n    ['address', 'address'],\r\n    ['token', 'token'],\r\n]);\r\nexport const blockExplorerUrl = (type, value, chainId) => {\r\n    if (!getKnownChainsIds().includes(chainId)) {\r\n        return '';\r\n    }\r\n    if (!EXPLORER_URL_TYPES.has(type)) {\r\n        throw new Error('type not supported.');\r\n    }\r\n    const domain = getChainInformation(chainId).explorerUrl;\r\n    const typePart = EXPLORER_URL_TYPES.get(type);\r\n    return `${domain}/${typePart}/${value}`;\r\n};\r\nexport function rpcResult(response) {\r\n    // Some providers don’t wrap the response\r\n    if (isUnwrappedRpcResult(response)) {\r\n        if (response.error) {\r\n            throw new Error(response.error);\r\n        }\r\n        return response.result || null;\r\n    }\r\n    return response || null;\r\n}\r\nasync function ethereumRequest(ethereum, method, params) {\r\n    // If ethereum.request() exists, the provider is probably EIP-1193 compliant.\r\n    if (ethereum.request) {\r\n        return ethereum.request({ method, params }).then(rpcResult);\r\n    }\r\n    // This is specific to some older versions of MetaMask combined with Web3.js.\r\n    if (ethereum.sendAsync && ethereum.selectedAddress) {\r\n        return new Promise((resolve, reject) => {\r\n            ethereum.sendAsync({\r\n                method,\r\n                params,\r\n                from: ethereum.selectedAddress,\r\n                jsonrpc: '2.0',\r\n                id: 0,\r\n            }, (err, result) => {\r\n                if (err) {\r\n                    reject(err);\r\n                }\r\n                else {\r\n                    resolve(result);\r\n                }\r\n            });\r\n        }).then(rpcResult);\r\n    }\r\n    // If none of the previous two exist, we assume the provider is pre EIP-1193,\r\n    // using .send() rather than .request().\r\n    if (ethereum.send) {\r\n        return ethereum.send(method, params).then(rpcResult);\r\n    }\r\n    throw new Error('The Ethereum provider doesn’t seem to provide a request method.');\r\n}\r\nexport async function getAccountIsContract(ethereum, account) {\r\n    try {\r\n        const code = await ethereumRequest(ethereum, 'eth_getCode', [account]);\r\n        return code !== '0x';\r\n    }\r\n    catch (err) {\r\n        return false;\r\n    }\r\n}\r\nexport async function getAccountBalance(ethereum, account) {\r\n    return ethereumRequest(ethereum, 'eth_getBalance', [account, 'latest']);\r\n}\r\nexport async function getBlockNumber(ethereum) {\r\n    return ethereumRequest(ethereum, 'eth_blockNumber', []);\r\n}\r\nexport function pollEvery(fn, delay) {\r\n    let timer; // can be TimeOut (Node) or number (web)\r\n    let stop = false;\r\n    const poll = async (request, onResult) => {\r\n        const result = await request();\r\n        if (!stop) {\r\n            onResult(result);\r\n            timer = setTimeout(poll.bind(null, request, onResult), delay);\r\n        }\r\n    };\r\n    return (...params) => {\r\n        const { request, onResult } = fn(...params);\r\n        stop = false;\r\n        poll(request, onResult);\r\n        return () => {\r\n            stop = true;\r\n            clearTimeout(timer);\r\n        };\r\n    };\r\n}\r\nconst ACCOUNT_KEY = 'LAST_ACTIVE_ACCOUNT';\r\nconst CONNECTOR_KEY = 'LAST_WALLET_CONNECTOR';\r\nexport const setLastActiveAccount = (account) => {\r\n    localStorage?.setItem(ACCOUNT_KEY, account);\r\n};\r\nexport const clearLastActiveAccount = () => {\r\n    localStorage?.removeItem(ACCOUNT_KEY);\r\n};\r\nexport const getLastActiveAccount = () => {\r\n    return localStorage?.getItem(ACCOUNT_KEY);\r\n};\r\nexport const setLastConnector = (connector) => {\r\n    localStorage?.setItem(CONNECTOR_KEY, connector);\r\n};\r\nexport const getLastConnector = () => {\r\n    return localStorage?.getItem(CONNECTOR_KEY);\r\n};\r\n//# sourceMappingURL=utils.js.map","references":["/Users/saleemfareed/use-wallet/src/types.ts","/Users/saleemfareed/use-wallet/src/chains.ts"],"map":"{\"version\":3,\"file\":\"utils.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/utils.ts\"],\"names\":[],\"mappings\":\"AACA,OAAO,EAAE,mBAAmB,EAAE,iBAAiB,EAAE,MAAM,UAAU,CAAA;AAEjE,SAAS,oBAAoB,CAAC,QAAiB;IAI7C,OAAO,CACL,OAAO,QAAQ,KAAK,QAAQ,IAAI,QAAQ,KAAK,IAAI,IAAI,SAAS,IAAI,QAAQ,CAC3E,CAAA;AACH,CAAC;AAED,MAAM,kBAAkB,GAAG,IAAI,GAAG,CAAC;IACjC,CAAC,OAAO,EAAE,OAAO,CAAC;IAClB,CAAC,aAAa,EAAE,IAAI,CAAC;IACrB,CAAC,SAAS,EAAE,SAAS,CAAC;IACtB,CAAC,OAAO,EAAE,OAAO,CAAC;CACnB,CAAC,CAAA;AAEF,MAAM,CAAC,MAAM,gBAAgB,GAAG,CAC9B,IAAY,EACZ,KAAa,EACb,OAAe,EACf,EAAE;IACF,IAAI,CAAC,iBAAiB,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;QAC1C,OAAO,EAAE,CAAA;KACV;IAED,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;QACjC,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAA;KACvC;IAED,MAAM,MAAM,GAAI,mBAAmB,CAAC,OAAO,CAAsB,CAAC,WAAW,CAAA;IAC7E,MAAM,QAAQ,GAAG,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;IAC7C,OAAO,GAAG,MAAM,IAAI,QAAQ,IAAI,KAAK,EAAE,CAAA;AACzC,CAAC,CAAA;AAED,MAAM,UAAU,SAAS,CAAC,QAAiB;IACzC,yCAAyC;IACzC,IAAI,oBAAoB,CAAC,QAAQ,CAAC,EAAE;QAClC,IAAI,QAAQ,CAAC,KAAK,EAAE;YAClB,MAAM,IAAI,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;SAChC;QACD,OAAO,QAAQ,CAAC,MAAM,IAAI,IAAI,CAAA;KAC/B;IAED,OAAO,QAAQ,IAAI,IAAI,CAAA;AACzB,CAAC;AAED,KAAK,UAAU,eAAe,CAC5B,QAA0B,EAC1B,MAAc,EACd,MAAgB;IAEhB,6EAA6E;IAC7E,IAAI,QAAQ,CAAC,OAAO,EAAE;QACpB,OAAO,QAAQ,CAAC,OAAO,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;KAC5D;IAED,6EAA6E;IAC7E,IAAI,QAAQ,CAAC,SAAS,IAAI,QAAQ,CAAC,eAAe,EAAE;QAClD,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACrC,QAAQ,CAAC,SAAS,CAChB;gBACE,MAAM;gBACN,MAAM;gBACN,IAAI,EAAE,QAAQ,CAAC,eAAe;gBAC9B,OAAO,EAAE,KAAK;gBACd,EAAE,EAAE,CAAC;aACN,EACD,CAAC,GAAU,EAAE,MAAW,EAAE,EAAE;gBAC1B,IAAI,GAAG,EAAE;oBACP,MAAM,CAAC,GAAG,CAAC,CAAA;iBACZ;qBAAM;oBACL,OAAO,CAAC,MAAM,CAAC,CAAA;iBAChB;YACH,CAAC,CACF,CAAA;QACH,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;KACnB;IAED,6EAA6E;IAC7E,wCAAwC;IACxC,IAAI,QAAQ,CAAC,IAAI,EAAE;QACjB,OAAO,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;KACrD;IAED,MAAM,IAAI,KAAK,CACb,iEAAiE,CAClE,CAAA;AACH,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,oBAAoB,CACxC,QAA0B,EAC1B,OAAgB;IAEhB,IAAI;QACF,MAAM,IAAI,GAAG,MAAM,eAAe,CAAC,QAAQ,EAAE,aAAa,EAAE,CAAC,OAAO,CAAC,CAAC,CAAA;QACtE,OAAO,IAAI,KAAK,IAAI,CAAA;KACrB;IAAC,OAAO,GAAG,EAAE;QACZ,OAAO,KAAK,CAAA;KACb;AACH,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,iBAAiB,CACrC,QAA0B,EAC1B,OAAgB;IAEhB,OAAO,eAAe,CAAC,QAAQ,EAAE,gBAAgB,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC,CAAA;AACzE,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,cAAc,CAAC,QAA0B;IAC7D,OAAO,eAAe,CAAC,QAAQ,EAAE,iBAAiB,EAAE,EAAE,CAAC,CAAA;AACzD,CAAC;AAED,MAAM,UAAU,SAAS,CACvB,EAQC,EACD,KAAa;IAEb,IAAI,KAAU,CAAA,CAAC,wCAAwC;IACvD,IAAI,IAAI,GAAG,KAAK,CAAA;IAChB,MAAM,IAAI,GAAG,KAAK,EAChB,OAAyB,EACzB,QAA6B,EAC7B,EAAE;QACF,MAAM,MAAM,GAAG,MAAM,OAAO,EAAE,CAAA;QAC9B,IAAI,CAAC,IAAI,EAAE;YACT,QAAQ,CAAC,MAAM,CAAC,CAAA;YAChB,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,CAAC,EAAE,KAAK,CAAC,CAAA;SAC9D;IACH,CAAC,CAAA;IACD,OAAO,CAAC,GAAG,MAAW,EAAE,EAAE;QACxB,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC,GAAG,MAAM,CAAC,CAAA;QAC3C,IAAI,GAAG,KAAK,CAAA;QACZ,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAA;QACvB,OAAO,GAAG,EAAE;YACV,IAAI,GAAG,IAAI,CAAA;YACX,YAAY,CAAC,KAAK,CAAC,CAAA;QACrB,CAAC,CAAA;IACH,CAAC,CAAA;AACH,CAAC;AAED,MAAM,WAAW,GAAG,qBAAqB,CAAA;AACzC,MAAM,aAAa,GAAG,uBAAuB,CAAA;AAE7C,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAAC,OAAgB,EAAE,EAAE;IACvD,YAAY,EAAE,OAAO,CAAC,WAAW,EAAE,OAAO,CAAC,CAAA;AAC7C,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,sBAAsB,GAAG,GAAG,EAAE;IACzC,YAAY,EAAE,UAAU,CAAC,WAAW,CAAC,CAAA;AACvC,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,oBAAoB,GAAG,GAAmB,EAAE;IACvD,OAAO,YAAY,EAAE,OAAO,CAAC,WAAW,CAAC,CAAA;AAC3C,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,gBAAgB,GAAG,CAAC,SAAiB,EAAE,EAAE;IACpD,YAAY,EAAE,OAAO,CAAC,aAAa,EAAE,SAAS,CAAC,CAAA;AACjD,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,gBAAgB,GAAG,GAAkB,EAAE;IAClD,OAAO,YAAY,EAAE,OAAO,CAAC,aAAa,CAAC,CAAA;AAC7C,CAAC,CAAA\"}"}
